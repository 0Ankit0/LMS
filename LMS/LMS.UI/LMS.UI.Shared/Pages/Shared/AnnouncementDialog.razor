@using MudBlazor
@using global::LMS.Data.DTOs

@code {
    [CascadingParameter] IMudDialogInstance MudDialog { get; set; }
    [Parameter] public AnnouncementModel Announcement { get; set; } = default!;

    private void Submit() => MudDialog.Close(DialogResult.Ok(true));

    private void Cancel() => MudDialog.Cancel();

    private MudBlazor.Color GetPriorityBadgeColor(string? priority)
    {
        return (priority ?? "").ToLower() switch
        {
            "high" => MudBlazor.Color.Error,
            "medium" => MudBlazor.Color.Warning,
            "low" => MudBlazor.Color.Info,
            _ => MudBlazor.Color.Secondary
        };
    }

    private string GetPriorityIcon(string priority)
    {
        return priority.ToLower() switch
        {
            "high" => Icons.Material.Filled.Warning,
            "medium" => Icons.Material.Filled.Info,
            "low" => Icons.Material.Filled.Notifications,
            _ => Icons.Material.Filled.Info
        };
    }
}

<MudDialog>
    <TitleContent>
        <MudText Typo="Typo.h6">@Announcement?.Title</MudText>
    </TitleContent>
    <DialogContent>
        @if (Announcement != null)
        {
            <div class="announcement-detail-meta mb-3">
                <div class="meta-item">
                    <MudIcon Icon="@Icons.Material.Filled.Person" Color="Color.Primary" />
                    <span>@Announcement.AuthorName</span>
                </div>
                <div class="meta-item">
                    <MudIcon Icon="@Icons.Material.Filled.CalendarToday" Color="Color.Primary" />
                    <span>@Announcement.PublishedAt.ToString("MMM dd, yyyy HH:mm")</span>
                </div>
                <div class="meta-item">
                    <MudChip T="string" Color="@GetPriorityBadgeColor(Announcement.Priority)">
                        <MudIcon Icon="@GetPriorityIcon(Announcement.Priority)" Class="me-1" />
                        @Announcement.Priority Priority
                    </MudChip>
                </div>
            </div>
            <div class="announcement-detail-content">
                @((MarkupString)Announcement.Content)
            </div>
        }
    </DialogContent>
    <DialogActions>
        <MudButton Color="Color.Secondary" OnClick="Cancel">Close</MudButton>
    </DialogActions>
</MudDialog>
