window.addEventListener("error",function(n){console.error("Global JavaScript Error:",{message:n.message,filename:n.filename,lineno:n.lineno,colno:n.colno,error:n.error});n.error&&n.error.stack&&console.error("Stack trace:",n.error.stack)});window.addEventListener("unhandledrejection",function(n){console.error("Unhandled Promise Rejection:",n.reason);console.error("Promise:",n.promise)});window.blazorErrorHandler={onError:function(n){return console.error("Blazor Error:",n),!1}};window.renderQrCode=(n,t)=>{try{const i=document.getElementById(n);if(!i){console.warn("QR Code container not found:",n);return}i.innerHTML="";new QRCode(i,{text:t,width:200,height:200})}catch(i){console.error("Error rendering QR code:",i)}};window.downloadFileFromBytes=(n,t,i)=>{try{const f=new Blob([new Uint8Array(i)],{type:t}),u=URL.createObjectURL(f),r=document.createElement("a");r.href=u;r.download=n;document.body.appendChild(r);r.click();document.body.removeChild(r);setTimeout(()=>URL.revokeObjectURL(u),1e3)}catch(r){console.error("Error downloading file:",r)}};window.showToast=(n,t="info",i=5e3)=>{try{let u=document.getElementById("toast-container");u||(u=document.createElement("div"),u.id="toast-container",u.style.cssText=`
                position: fixed;
                top: 20px;
                right: 20px;
                z-index: 9999;
                display: flex;
                flex-direction: column;
                gap: 10px;
                pointer-events: none;
            `,document.body.appendChild(u));const r=document.createElement("div");r.style.cssText=`
            background: ${t==="success"?"#28a745":t==="error"?"#dc3545":t==="warning"?"#ffc107":"#17a2b8"};
            color: ${t==="warning"?"#212529":"#fff"};
            padding: 12px 16px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            max-width: 300px;
            word-wrap: break-word;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-size: 14px;
            line-height: 1.4;
            pointer-events: auto;
            transform: translateX(100%);
            opacity: 0;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        `;const f={success:"✓",error:"✗",warning:"⚠",info:"ℹ"},o=f[t]||f.info;r.innerHTML=`
            <div style="display: flex; align-items: center; gap: 8px;">
                <span style="font-weight: bold; font-size: 16px;">${o}</span>
                <span>${n}</span>
            </div>
        `;u.appendChild(r);requestAnimationFrame(()=>{r.style.transform="translateX(0)",r.style.opacity="1"});const e=()=>{r.style.transform="translateX(100%)",r.style.opacity="0",setTimeout(()=>{r.parentElement&&r.parentElement.removeChild(r),u.children.length===0&&document.body.removeChild(u)},300)};r.addEventListener("click",e);setTimeout(e,i)}catch(r){console.error("Error showing toast:",r);alert(n)}};window.drawLineChart=(n,t)=>{const i=document.getElementById(n);if(i){window.charts&&window.charts[n]&&window.charts[n].destroy();window.charts||(window.charts={});const r=new Chart(i,{type:"line",data:{labels:t.map(n=>n.label),datasets:[{label:"New Enrollments",data:t.map(n=>n.newEnrollments),borderColor:"#007bff",backgroundColor:"rgba(0, 123, 255, 0.1)",borderWidth:3,fill:!0,tension:.4,pointBackgroundColor:"#007bff",pointBorderColor:"#ffffff",pointBorderWidth:2,pointRadius:6},{label:"Completed",data:t.map(n=>n.completedEnrollments),borderColor:"#28a745",backgroundColor:"rgba(40, 167, 69, 0.1)",borderWidth:3,fill:!0,tension:.4,pointBackgroundColor:"#28a745",pointBorderColor:"#ffffff",pointBorderWidth:2,pointRadius:6}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{usePointStyle:!0,padding:20,font:{size:12,weight:"500"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"#007bff",borderWidth:1,cornerRadius:8,displayColors:!0,mode:"index",intersect:!1}},scales:{x:{grid:{display:!1},ticks:{font:{size:11},color:"#6c757d"}},y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.1)",drawBorder:!1},ticks:{font:{size:11},color:"#6c757d"}}},interaction:{mode:"index",intersect:!1},elements:{point:{hoverRadius:8}}}});window.charts[n]=r}};window.drawDoughnutChart=(n,t)=>{const i=document.getElementById(n);if(i){window.charts&&window.charts[n]&&window.charts[n].destroy();window.charts||(window.charts={});const r=new Chart(i,{type:"doughnut",data:{labels:["Excellent (80%+)","Good (60-79%)","Average (40-59%)","Poor (<40%)"],datasets:[{data:[t.excellent,t.good,t.average,t.poor],backgroundColor:["#28a745","#17a2b8","#ffc107","#dc3545"],borderColor:["#ffffff","#ffffff","#ffffff","#ffffff"],borderWidth:3,hoverOffset:10}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{usePointStyle:!0,padding:15,font:{size:10,weight:"500"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"#007bff",borderWidth:1,cornerRadius:8,displayColors:!0,callbacks:{label:function(n){const t=n.dataset.data.reduce((n,t)=>n+t,0),i=(n.parsed/t*100).toFixed(1);return`${n.label}: ${n.parsed} courses (${i}%)`}}}},cutout:"60%",elements:{arc:{borderRadius:5}}}});window.charts[n]=r}};window.drawEnrollmentChart=(n,t)=>{const i=document.getElementById(n);if(i){window.charts&&window.charts[n]&&window.charts[n].destroy();window.charts||(window.charts={});const r=new Chart(i,{type:"bar",data:{labels:t.map(n=>n.label),datasets:[{label:"New Enrollments",data:t.map(n=>n.newEnrollments),backgroundColor:"rgba(0, 123, 255, 0.8)",borderColor:"#007bff",borderWidth:2,borderRadius:8,borderSkipped:!1},{label:"Completed",data:t.map(n=>n.completedEnrollments),backgroundColor:"rgba(40, 167, 69, 0.8)",borderColor:"#28a745",borderWidth:2,borderRadius:8,borderSkipped:!1},{label:"Dropped",data:t.map(n=>n.droppedEnrollments),backgroundColor:"rgba(220, 53, 69, 0.8)",borderColor:"#dc3545",borderWidth:2,borderRadius:8,borderSkipped:!1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{usePointStyle:!0,padding:20,font:{size:12,weight:"500"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"#007bff",borderWidth:1,cornerRadius:8,displayColors:!0}},scales:{x:{grid:{display:!1},ticks:{font:{size:11},color:"#6c757d"}},y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.1)",drawBorder:!1},ticks:{font:{size:11},color:"#6c757d"}}}}});window.charts[n]=r}};document.addEventListener("DOMContentLoaded",function(){Chart.defaults.font.family="'Segoe UI', Tahoma, Geneva, Verdana, sans-serif";Chart.defaults.color="#495057";Chart.defaults.scale.grid.color="rgba(0, 0, 0, 0.1)"});window.addEventListener("beforeunload",function(){window.charts&&Object.values(window.charts).forEach(n=>{n&&typeof n.destroy=="function"&&n.destroy()})});window.getScrollInfo=n=>n?{scrollTop:n.scrollTop,scrollHeight:n.scrollHeight,clientHeight:n.clientHeight}:{scrollTop:0,scrollHeight:0,clientHeight:0};window.addClickOutsideListener=(n,t)=>{const i=i=>{n.contains(i.target)||t.invokeMethodAsync("CloseDropdown")};return document.addEventListener("click",i),()=>{document.removeEventListener("click",i)}};