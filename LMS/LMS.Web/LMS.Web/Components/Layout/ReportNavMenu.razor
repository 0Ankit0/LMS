@using Microsoft.AspNetCore.Components.Authorization
@inject AuthenticationStateProvider AuthenticationStateProvider
@rendermode InteractiveAuto

<MudAppBar Elevation="0">
    <MudIconButton Icon="@(isNavbarCollapsed ? Icons.Material.Filled.ChevronRight : Icons.Material.Filled.ChevronLeft)" Color="Color.Inherit" Edge="Edge.Start" OnClick="ToggleNavbar" Title="@(isNavbarCollapsed ? "Expand sidebar" : "Collapse sidebar")" />
    <MudSpacer />
    <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" Edge="Edge.End" OnClick="ToggleMobileMenu" Title="Toggle navigation menu" />
</MudAppBar>

<MudNavMenu Class="@($"nav-scrollable {GetNavScrollableClasses()}")" Style="@(isMobileMenuOpen ? "display: block;" : "")">
    <!-- Dashboard -->
    <MudNavLink Href="/reports" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Dashboard" Style="line-height: 1.2; font-size: 0.97rem;">Dashboard</MudNavLink>

    <!-- Academic Reports Section -->
    <MudNavGroup Title="Academic Reports" Icon="@Icons.Material.Filled.School" Expanded="true">
        <MudNavLink Href="/reports/course-completion" Icon="@Icons.Material.Filled.BarChart" Style="line-height: 1.2; font-size: 0.97rem;">Course Completion</MudNavLink>
        <MudNavLink Href="/reports/assessment-performance" Icon="@Icons.Material.Filled.AssignmentTurnedIn" Style="line-height: 1.2; font-size: 0.97rem;">Assessment Performance</MudNavLink>
        <MudNavLink Href="/reports/enrollment-summary" Icon="@Icons.Material.Filled.People" Style="line-height: 1.2; font-size: 0.97rem;">Enrollment Summary</MudNavLink>
        <MudNavLink Href="/reports/enrollment-trends" Icon="@Icons.Material.Filled.TrendingUp" Style="line-height: 1.2; font-size: 0.97rem;">Enrollment Trends</MudNavLink>
    </MudNavGroup>

    <!-- Student Reports Section -->
    <MudNavGroup Title="Student Reports" Icon="@Icons.Material.Filled.Person" Expanded="true">
        <MudNavLink Href="/reports/student-information" Icon="@Icons.Material.Filled.Badge" Style="line-height: 1.2; font-size: 0.97rem;">Student Information</MudNavLink>
        <MudNavLink Href="/reports/student-progress" Icon="@Icons.Material.Filled.ShowChart" Style="line-height: 1.2; font-size: 0.97rem;">Student Progress</MudNavLink>
        <MudNavLink Href="/reports/low-performance" Icon="@Icons.Material.Filled.Warning" Style="line-height: 1.2; font-size: 0.97rem;">Low Performance</MudNavLink>
        <MudNavLink Href="/reports/student-engagement" Icon="@Icons.Material.Filled.LocalActivity" Style="line-height: 1.2; font-size: 0.97rem;">Student Engagement</MudNavLink>
    </MudNavGroup>

    <!-- Attendance Reports Section -->
    <MudNavGroup Title="Attendance Reports" Icon="@Icons.Material.Filled.EventAvailable" Expanded="true">
        <MudNavLink Href="/reports/attendance" Icon="@Icons.Material.Filled.EventNote" Style="line-height: 1.2; font-size: 0.97rem;">Class Attendance</MudNavLink>
        <MudNavLink Href="/reports/student-attendance" Icon="@Icons.Material.Filled.PersonPin" Style="line-height: 1.2; font-size: 0.97rem;">Student Attendance</MudNavLink>
    </MudNavGroup>

    <!-- Forum Reports Section -->
    <MudNavGroup Title="Forum Reports" Icon="@Icons.Material.Filled.Forum" Expanded="true">
        <MudNavLink Href="/reports/forum-activity" Icon="@Icons.Material.Filled.Chat" Style="line-height: 1.2; font-size: 0.97rem;">Forum Activity</MudNavLink>
    </MudNavGroup>

    <!-- Analytics Section -->
    <MudNavGroup Title="Analytics" Icon="@Icons.Material.Filled.Analytics" Expanded="true">
        <MudNavLink Href="/reports/popular-courses" Icon="@Icons.Material.Filled.Star" Style="line-height: 1.2; font-size: 0.97rem;">Popular Courses</MudNavLink>
        <MudNavLink Href="/reports/difficult-assessments" Icon="@Icons.Material.Filled.LocalFireDepartment" Style="line-height: 1.2; font-size: 0.97rem;">Difficult Assessments</MudNavLink>
        <MudNavLink Href="/reports/learning-analytics" Icon="@Icons.Material.Filled.Lightbulb" Style="line-height: 1.2; font-size: 0.97rem;">Learning Analytics</MudNavLink>
        <MudNavLink Href="/reports/grade-distribution" Icon="@Icons.Material.Filled.BarChart" Style="line-height: 1.2; font-size: 0.97rem;">Grade Distribution</MudNavLink>
    </MudNavGroup>

    <!-- Teacher Reports Section -->
    <MudNavGroup Title="Teacher Reports" Icon="@Icons.Material.Filled.School" Expanded="true">
        <MudNavLink Href="/reports/teacher-performance" Icon="@Icons.Material.Filled.AssignmentInd" Style="line-height: 1.2; font-size: 0.97rem;">Teacher Performance</MudNavLink>
    </MudNavGroup>

    <!-- Advanced Analytics Section -->
    <MudNavGroup Title="Advanced Analytics" Icon="@Icons.Material.Filled.TrendingUp" Expanded="true">
        <MudNavLink Href="/reports/academic-trends" Icon="@Icons.Material.Filled.TrendingUp" Style="line-height: 1.2; font-size: 0.97rem;">Academic Trends</MudNavLink>
        <MudNavLink Href="/reports/risk-students" Icon="@Icons.Material.Filled.Warning" Style="line-height: 1.2; font-size: 0.97rem;">Risk Students</MudNavLink>
    </MudNavGroup>
</MudNavMenu>

@code {
    private bool isNavbarCollapsed = true; // Start contracted by default
    private bool isMobileMenuOpen = false; // Mobile menu state

    private void ToggleNavbar()
    {
        isNavbarCollapsed = !isNavbarCollapsed;
    }

    private void ToggleMobileMenu()
    {
        isMobileMenuOpen = !isMobileMenuOpen;
    }

    private string GetNavScrollableClasses()
    {
        var classes = new List<string>();

        if (isNavbarCollapsed)
        {
            classes.Add("collapsed");
        }

        return string.Join(" ", classes);
    }
}